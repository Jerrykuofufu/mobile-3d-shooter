<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Gravity Courier Run</title>

<style>
:root{
  --bg:#eef6ff;
  --card:#ffffff;
  --ink:#111;
  --muted:#6b7280;
  --neon1:#a5f3fc;
  --neon2:#c7d2fe;
}
*{box-sizing:border-box;font-family:system-ui,-apple-system,BlinkMacSystemFont;}
body{
  margin:0;
  background:linear-gradient(180deg,#eaf3ff,#f8fbff);
}
.wrap{
  max-width:900px;
  margin:14px auto;
  padding:12px;
}
.panel{
  background:var(--card);
  border-radius:18px;
  padding:14px;
  box-shadow:0 20px 40px rgba(0,0,0,.08);
}
h1{margin:6px 0 10px;font-size:32px}
.chips{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px}
.chip{
  padding:6px 12px;
  border-radius:999px;
  border:2px dashed #d1d5db;
  background:#fff;
  font-size:13px;
}
.stage{
  margin:10px 0;
  border-radius:18px;
  padding:10px;
  background:linear-gradient(135deg,var(--neon1),var(--neon2));
}
.stage-inner{
  background:#f0f7ff;
  border-radius:14px;
  padding:8px;
}
canvas{
  width:100%;
  height:220px;
  display:block;
  background:#eaf2ff;
  border-radius:12px;
}
.stats{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
  margin:10px 0;
  font-weight:700;
}
.controls{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  align-items:center;
}
input{
  padding:10px;
  border-radius:12px;
  border:2px dashed #c7d2fe;
  width:140px;
}
button{
  padding:10px 16px;
  border-radius:14px;
  border:2px dashed #c7d2fe;
  background:#fff;
  font-weight:800;
}
.small{font-size:13px;color:var(--muted)}
</style>
</head>

<body>
<div class="wrap">
  <div class="panel">
    <h1>ğŸ›µ Gravity Courier Run</h1>

    <div class="chips">
      <div class="chip">é»ä¸€ä¸‹ç¿»è½‰é‡åŠ› âœ¨</div>
      <div class="chip">æ‰‹æ©Ÿè¶…é †</div>
      <div class="chip">Combo è¶Šé«˜åŠ åˆ†è¶Šé¦™ ğŸ•</div>
    </div>

    <div class="stage">
      <div class="stage-inner">
        <canvas id="game" width="800" height="220"></canvas>
      </div>
    </div>

    <div class="stats">
      <div>Score: <span id="score">0</span></div>
      <div>Best: <span id="best">0</span></div>
      <div>Combo: <span id="combo">0</span></div>
      <div>Speed: <span id="speed">1.0</span></div>
    </div>

    <div class="controls">
      <input id="name" placeholder="Name (â‰¤12)" maxlength="12">
      <button id="restart">é‡æ–°é–‹å§‹</button>
      <button id="sfx">SFX: ON</button>
      <button id="bgm">BGM: OFF</button>
    </div>

    <p class="small">
      æ“ä½œï¼šé»ä¸€ä¸‹ / ç©ºç™½éµ â†’ ç¿»è½‰é‡åŠ›ï¼ˆåœ°æ¿ â‡„ å¤©èŠ±æ¿ï¼‰<br>
      æ²’æœ‰é˜²ç§’é–‹ï¼Œé»äº†å°±è·‘ ğŸ˜¼
    </p>
  </div>
</div>

<script>
/* ================= åŸºæœ¬è¨­å®š ================= */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let running = true;            // âœ… é˜²ç§’é–‹å·²åˆªï¼šä¸€é–‹å§‹å°±å¯è·‘
let gravity = 0.6;
let dir = 1;                   // 1=å‘ä¸‹ï¼Œ-1=å‘ä¸Š
let speed = 3;
let score = 0;
let combo = 0;
let best = Number(localStorage.best || 0);

const scoreEl = scoreEl = document.getElementById("score");
const comboEl = document.getElementById("combo");
const speedEl = document.getElementById("speed");
document.getElementById("best").textContent = best;

/* ================= ç©å®¶ ================= */
const player = {
  x:80,
  y:canvas.height-40,
  vy:0,
  r:10
};

/* ================= éšœç¤™ ================= */
let blocks = [];
function spawn(){
  blocks.push({
    x:canvas.width+40,
    w:14,
    h:60+Math.random()*80,
    top:Math.random()<0.5
  });
}

/* ================= æ“ä½œ ================= */
function flip(){
  dir *= -1;
}
canvas.addEventListener("click",flip);
document.addEventListener("keydown",e=>{
  if(e.code==="Space") flip();
});
document.getElementById("restart").onclick=reset;

/* ================= ä¸»è¿´åœˆ ================= */
function reset(){
  blocks=[];
  score=0;
  combo=0;
  speed=3;
  dir=1;
  player.y=canvas.height-40;
  player.vy=0;
  running=true;
}
function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // player
  player.vy += gravity*dir;
  player.y += player.vy;
  if(player.y<player.r){player.y=player.r;player.vy=0}
  if(player.y>canvas.height-player.r){player.y=canvas.height-player.r;player.vy=0}

  ctx.fillStyle="#111";
  ctx.beginPath();
  ctx.arc(player.x,player.y,player.r,0,Math.PI*2);
  ctx.fill();

  // blocks
  if(Math.random()<0.02) spawn();
  blocks.forEach(b=>{
    b.x -= speed;
    ctx.fillRect(b.x,b.top?0:canvas.height-b.h,b.w,b.h);

    if(
      player.x+player.r>b.x &&
      player.x-player.r<b.x+b.w &&
      (b.top ? player.y-player.r<b.h : player.y+player.r>canvas.height-b.h)
    ){
      running=false;
    }
  });
  blocks=blocks.filter(b=>b.x>-50);

  if(running){
    score++;
    combo++;
    speed=3+score/400;
  }else{
    combo=0;
  }

  scoreEl.textContent=score;
  comboEl.textContent=combo;
  speedEl.textContent=speed.toFixed(1);

  if(score>best){
    best=score;
    localStorage.best=best;
    document.getElementById("best").textContent=best;
  }

  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
